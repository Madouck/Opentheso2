<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"  
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:p="http://primefaces.org/ui">

    <div style="max-height: 700px; overflow: auto;" >
        <div style="width: 100%; display: flex;">
            <div style="width: 50%;">  
                <h:outputText rendered="#{tree.manySiblings}" value="#{langueBean.getMsg('tree.manySiblings')}"
                              title="#{langueBean.getMsg('tree.tooltip_manySiblings')}"
                              style="color: red; font-style: italic; background-color: yellow"/>
            </div>
            <div style="width: 50%; text-align: right;">
                <p:link href="#{request.contextPath}/graph/index.xhtml"
                        target="_blank" disabled="#{tree.selectedNode.leaf or tree.selectedNode == null}"
                        style="color: #F47B2A; float: right; margin-top: 2px;">
                    <i class="pi pi-share-alt" style="font-size: 1rem" />
                </p:link>

                <p:menuButton style="margin-right: 10px; background-color: transparent" icon="pi pi-align-justify" >

                    <p:menuitem icon="pi pi-lis" value="#{langueBean.getMsg('leftbody.alphabetic_sort')}"
                                actionListener="#{selectedTheso.setSortByNotation(false)}" ajax="true"
                                action="#{selectedTheso.reloadSelectedTheso()}"
                                process="@this"
                                disabled="#{!selectedTheso.sortByNotation}"
                                update="containerIndex:formLeftTab"/>

                    <p:menuitem icon="pi pi-lis" value="#{langueBean.getMsg('leftbody.notation_sort')}"
                                actionListener="#{selectedTheso.setSortByNotation(true)}" ajax="true"
                                action="#{selectedTheso.reloadSelectedTheso()}"
                                disabled="#{selectedTheso.sortByNotation}"
                                process="@this" update="containerIndex:formLeftTab" />

                    <p:menuitem icon="pi pi-lis" value="Add top concept" action="#{newConcept.reset()}" 
                                oncomplete="PF('addTopConcept').show();"
                                update="idAddTopConcept"
                                rendered="#{(currentUser.nodeUser != null) and 
                                            (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"/>

                    <p:menuitem rendered="#{copyAndPasteBetweenTheso.isCopyOn and (currentUser.nodeUser != null) 
                                            and (roleOnTheso.isManagerOnThisTheso or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}" 
                                value="Annuler copie" styleClass="buttonIconOrange" action="#{copyAndPasteBetweenTheso.reset()}" 
                                update="idGlobalActionsTree messageIndex" />                

                    <p:menuitem disabled="false" styleClass="buttonIconOrange"
                                rendered="#{(copyAndPasteBetweenTheso.isCopyOn) and (copyAndPasteBetweenTheso.idThesoOrigin != selectedTheso.currentIdTheso) }"
                                value="Coller (#{copyAndPasteBetweenTheso.nodeConceptDrag.term.lexical_value}) Ã  la racine !!" 
                                actionListener="#{copyAndPasteBetweenTheso.validatePaste()}"
                                action="#{copyAndPasteBetweenTheso.setIsDropToRoot(true)}"
                                update="idCopyAndPasteBetweenThesoToTop copyAndPasteBetweenThesoToTopForm"
                                oncomplete="PF('copyAndPasteBetweenThesoToTop').show();" />
                </p:menuButton> 
            </div>
        </div>

        <p:tree value="#{tree.root}" dynamic="true" var="nodetree" selectionMode="single" selection="#{tree.selectedNode}"
                style="width: auto; border: none; font-size: 12px;" animate="true"
                styleClass="tree_custom" cache="#{roleOnTheso.nodePreference.tree_cache}"
                draggable="#{tree.isDragAndDrop(currentUser.nodeUser)}" droppable="#{tree.isDragAndDrop(currentUser.nodeUser)}" 
                widgetVar="treeWidget">

            <p:ajax event="expand" listener="#{tree.onNodeExpand}"/>
            <p:ajax event="collapse" listener="#{tree.onNodeCollapse}" />
            <p:ajax event="select" listener="#{tree.onNodeSelect}" update="containerIndex"/>
            <p:ajax event="dragdrop" listener="#{dragAndDrop.onDragDrop}" update="containerIndex" />

            <p:treeNode expandedIcon="pi pi-folder-open" collapsedIcon="pi pi-folder" >
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.notation} " style="font-size: 12px; color: blue"/>
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.name}" style="font-size: 12px"/>
            </p:treeNode>

            <p:treeNode type="concept" expandedIcon="pi pi-folder-open pi_custom_open" collapsedIcon="pi pi-folder pi_custom_collapse" >
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.notation} " style="font-size: 12px; color: blue"/>
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.name}" style="font-size: 12px"/>
            </p:treeNode>

            <p:treeNode type="file" icon="pi pi-file-o pi-file">
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.notation} " style="font-size: 12px; color: blue"/>
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.name}"  style="font-size: 12px"/>
            </p:treeNode>

            <p:treeNode type="facet" icon="fa fa-magnet fa_custom_magnet">
                <h:outputText title="#{nodetree.nodeId}" value="#{nodetree.name}" style="font-size: 12px"/>
            </p:treeNode>

        </p:tree>
    </div>
    
    <ui:include src="../../dialog/concept/addTopConcept.xhtml" />
    
</ui:fragment>