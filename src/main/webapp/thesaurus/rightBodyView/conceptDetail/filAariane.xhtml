<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
             xmlns:h="http://java.sun.com/jsf/html"  
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:p="http://primefaces.org/ui"
             xmlns:leaf="http://java.sun.com/jsf/composite/jsf2leaf">

    <div style="width: 100%; display: flex; background-color: #ecf8f1; padding-top: 3px; padding-bottom: 3px">

        <div style="height: 100%; vertical-align: central;">
            <h:panelGroup id="idConceptViewActions" >
                <p:menuButton icon="pi pi-align-justify" rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso 
                                                                     or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}">

                    <p:menuitem rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso 
                                            or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                                actionListener="#{addConcept.reset()}" oncomplete="PF('addNT').show();"
                                update="idAddNT" value="#{langueBean.getMsg('rightbody.concept.new_concept')}"
                                icon="fas fa-plus"/>

                    <p:menuitem rendered="#{(currentUser.nodeUser != null) and (roleOnTheso.isManagerOnThisTheso 
                                            or roleOnTheso.isAdminOnThisTheso or roleOnTheso.isSuperAdmin)}"
                                actionListener="#{editFacet.initNewFacet()}" icon="fas fa-calendar-plus"
                                update="idAddFacet" oncomplete="PF('addFacet').show();" 
                                value="#{langueBean.getMsg('rightbody.concept.new_facet')}"/>

                    <p:menuitem  value="#{langueBean.getMsg('rightbody.concept.cut_move')}"
                                 action="#{dragAndDrop.setDragNode(tree.selectedNode)}"
                                 actionListener="#{dragAndDrop.onStartCut(conceptView.nodeConcept)}"
                                 ajax="true" icon="fas fa-cut" update="containerIndex messageIndex" />

                    <p:menuitem rendered="#{(dragAndDrop.isCopyOn) and
                                            (dragAndDrop.cuttedConcept.concept.idConcept != conceptView.nodeConcept.concept.idConcept)}"
                                value="#{langueBean.getMsg('rightbody.concept.paste')} #{cutAndPaste.nodeConceptDrag.term.lexical_value} #{langueBean.getMsg('rightbody.concept.as_specific')}"
                                actionListener="#{dragAndDrop.setDropNode(tree.selectedNode)}"
                                action="#{dragAndDrop.paste(conceptView.nodeConcept)}" icon="fas fa-paste"
                                ajax="true" update="containerIndex messageIndex" />

                    <p:menuitem rendered="#{(dragAndDrop.isCopyOn) and (!dragAndDrop.cuttedConcept.concept.topConcept)}"
                                value="#{langueBean.getMsg('rightbody.concept.paste')} #{cutAndPaste.nodeConceptDrag.term.lexical_value} #{langueBean.getMsg('rightbody.concept.at_the_root')}"
                                actionListener="#{dragAndDrop.setIsDropToRoot(true)}"
                                action="#{dragAndDrop.paste(null)}" ajax="true"
                                update="containerIndex messageIndex" />

                    <p:menuitem value="#{langueBean.getMsg('rightbody.concept.delete_concept')}"
                                actionListener="#{editConcept.infosDelete()}" icon="far fa-trash-alt"
                                action="#{editConcept.reset('')}" update="idDeprecateConcept"
                                oncomplete="PF('deleteConcept').show();"  />

                    <p:menuitem rendered="#{conceptView.nodeConcept.concept.isDeprecated}"
                                value="#{langueBean.getMsg('rightbody.concept.approve_concept')}"
                                update="idApproveConcept" action="#{editConcept.reset('')}"
                                oncomplete="PF('approveConcept').show();"  />

                    <p:menuitem value="#{langueBean.getMsg('rightbody.concept.addConceptTofacet')}"
                            icon="fas fa-magnet" update="idAddConceptToFacet addConceptToFacetForm"
                            action="#{editConcept.reset('')}"
                            oncomplete="PF('addConceptToFacet').show();" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useArk) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_ark')}" 
                                disabled="false"                                      
                                actionListener="#{editConcept.infosArk()}"
                                update="idGenerateArk"
                                action="#{editConcept.reset('')}"
                                oncomplete="PF('generateArk').show();"
                                style="font-size: 12px;" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useHandle) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_handle')}" 
                                disabled="false"                                      
                                actionListener="#{editConcept.infosHandle()}"
                                update="idGenerateHandle"
                                action="#{editConcept.reset('')}"
                                oncomplete="PF('generateHandle').show();"
                                style="font-size: 12px;" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useHandle) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.delete_handle')}" 
                                disabled="false"                                      
                                actionListener="#{editConcept.infosDeleteHandle()}"
                                update="idDeleteHandle"
                                action="#{editConcept.reset('')}"
                                oncomplete="PF('deleteHandle').show();"
                                style="font-size: 12px;"/>

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useArk) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_missing_ark')}"
                                disabled="false"
                                action="#{editConcept.generateArkForConceptWithoutArk()}"
                                update="messageIndex"
                                style="font-size: 12px;" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useArk) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_ark_for_branch')}"
                                disabled="false" action="#{editConcept.generateArkForThisBranch()}"
                                update="messageIndex" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useArk) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_all_ark')}"
                                disabled="false" action="#{editConcept.generateAllArk()}"
                                update="messageIndex"/>

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useHandle) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_missing_handle')}" 
                                disabled="false" action="#{editConcept.generateHandleForConceptWithoutHandle()}"
                                update="messageIndex" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useHandle) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_handle_for_branch')}"
                                disabled="false" action="#{editConcept.generateHandleForThisBranch()}"
                                update="messageIndex" />

                    <p:menuitem rendered="#{(roleOnTheso.nodePreference.useHandle) and (currentUser.nodeUser.isSuperAdmin or roleOnTheso.isAdminOnThisTheso)}"
                                value="#{langueBean.getMsg('rightbody.concept.generate_all_handle')}"
                                disabled="false" action="#{editConcept.generateAllHandle()}"
                                update="messageIndex" />

                    <p:menuitem disabled="false" rendered="#{!copyAndPasteBetweenTheso.isCopyOn}"
                                value="#{langueBean.getMsg('rightbody.concept.copy_to_another_thesaurus')}"
                                actionListener="#{copyAndPasteBetweenTheso.onStartCopy()}"
                                icon="fas fa-truck-moving" update="idConceptViewActions messageIndex" />

                    <p:menuitem rendered="#{(copyAndPasteBetweenTheso.isCopyOn) and (copyAndPasteBetweenTheso.idThesoOrigin != selectedTheso.currentIdTheso) }"
                                value="#{langueBean.getMsg('rightbody.concept.paste')} (#{copyAndPasteBetweenTheso.nodeConceptDrag.term.lexical_value}) #{langueBean.getMsg('rightbody.concept.here')} !!" 
                                actionListener="#{copyAndPasteBetweenTheso.validatePaste()}" icon="fas fa-paste"
                                action="#{copyAndPasteBetweenTheso.setIsDropToRoot(false)}"
                                update="containerIndex"
                                oncomplete="PF('copyAndPasteBetweenTheso').show();" />

                    <p:menuitem  rendered="#{copyAndPasteBetweenTheso.isCopyOn}"
                                 value="#{langueBean.getMsg('rightbody.concept.cancel_copy')}"
                                 action="#{copyAndPasteBetweenTheso.reset()}" icon="fas fa-ban"
                                 update="idConceptViewActions messageIndex" />            

                    <p:menuitem value="#{langueBean.getMsg('rightbody.concept.import_tabulated_list')}"
                                actionListener="#{editConcept.infosDelete()}" icon="fas fa-file-upload"
                                update="idListImportCsv listImportCsvForm" action="#{importFileBean.init()}"
                                oncomplete="PF('listImportCsv').show();"/>

                    <p:menuitem rendered="#{currentUser.nodeUser.isSuperAdmin}"
                                      value="Importer des alignements d'après un tableau CSV"
                                      update="idListAlignmentCsv listAlignmentCsvForm"
                                      action="#{importFileBean.init()}" icon="fas fa-file-import"
                                      oncomplete="PF('listAlignmentCsv').show();" />

                    <p:menuitem rendered="#{currentUser.nodeUser.isSuperAdmin}"
                                      value="Supprimer des alignements d'après un tableau CSV"
                                      update="idDeleteListAlignmentCsv deleteListAlignmentCsvForm"
                                      action="#{importFileBean.init()}" icon="fas fa-remove-format"
                                      oncomplete="PF('deleteListAlignmentCsv').show();" />

                </p:menuButton>
            </h:panelGroup>
        </div>
        <div style="height: 100%; vertical-align: central;">
            <ui:repeat var="path" value="#{conceptView.pathLabel}" >
                <h:panelGroup rendered="#{path.isStartOfPath}">
                    <i class="fas fa-home" size="xs" style="color: #f47b2a;"/>
                </h:panelGroup>
                <p:commandLink rendered="#{path.isIsStartOfPath()}" style="color:#43B572; background: none; border: none; box-shadow: none; font-size: 12px"
                               value=" #{path.title}" action="#{conceptView.getConcept(selectedTheso.selectedIdTheso,
                                         path.idConcept, selectedTheso.currentLang)}" update="containerIndex" /> 
                <p:commandLink rendered="#{!path.isStartOfPath}" style="color:#43B572; background: none; border: none; box-shadow: none; font-size: 12px"
                               value="#{path.title}" action="#{conceptView.getConcept(selectedTheso.selectedIdTheso, path.idConcept, selectedTheso.currentLang)}"
                               update="containerIndex"/>                     
                <h:outputText value=" > " style="font-size: 12px; font-weight: bold"/>
            </ui:repeat>

            <i rendered="#{conceptView.nodeConcept.concept.topConcept}" value="fas fa-home" size="xs" style="color: #f47b2a;"/>
            <h:outputText rendered="#{conceptView.nodeConcept.term.lexical_value != ''}" value=" #{conceptView.nodeConcept.term.lexical_value}" style="font-size: 12px;"/>
            <h:outputText rendered="#{conceptView.nodeConcept.term.lexical_value == ''}" value=" (#{conceptView.nodeConcept.concept.idConcept})" style="font-size: 12px;"/>                
            <h:outputText value=" > " style="font-size: 12px; font-weight: bold"/>
        </div>
    </div>

    <ui:include src="../../../dialog/facet/addFacet.xhtml" />
    <ui:include src="../../../dialog/facet/addConceptToFacet.xhtml" />

    <ui:include src="../../../dialog/concept/addNT.xhtml" /> 
    <ui:include src="../../../dialog/concept/deleteConcept.xhtml" />
    <ui:include src="../../../dialog/concept/deprecateConcept.xhtml" />
    <ui:include src="../../../dialog/concept/approveConcept.xhtml" />
    <ui:include src="../../../dialog/concept/generateArk.xhtml" />
    <ui:include src="../../../dialog/concept/generateHandle.xhtml" />
    <ui:include src="../../../dialog/concept/deleteHandle.xhtml" />

    <ui:include src="../../../dialog/import/listImportCsv.xhtml" />
    <ui:include src="../../../dialog/import/listAlignmentCsv.xhtml" />
    <ui:include src="../../../dialog/import/deleteListAlignmentCsv.xhtml" />

</ui:fragment>