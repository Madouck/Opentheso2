<ui:fragment xmlns="http://www.w3.org/1999/xhtml"  
             xmlns:ui="http://java.sun.com/jsf/facelets"
             xmlns:f="http://java.sun.com/jsf/core"
             xmlns:h="http://xmlns.jcp.org/jsf/html"
             xmlns:p="http://primefaces.org/ui">

    <style>
        .bg-soft-base {
            background-color: #e1f5f7;
        }
        .bg-soft-warning {
            background-color: #fff4e1;
        }
        .bg-soft-success {
            background-color: #d1f6f2;
        }
        .bg-soft-danger {
            background-color: #fedce0;
        }
        .bg-soft-info {
            background-color: #d7efff;
        }

        .search-form {
            width: 80%;
            height: 33px;
            margin: 0 auto;
            margin-top: 1rem;
        }
        .ui-selectonemenu.form-control {
            border-color: transparent !important;
            border: transparent !important;
            height: 33px;
        }
        .search-form input {
            height: 100%;
            background: transparent;
            border: 0;
            display: block;
            width: 100%;
            padding: 1rem;
            height: 33px;
            font-size: 1rem;
        }

        .search-form select {
            background: transparent;
            border: 0;

            font-size: 12px;
            height: 33px;
        }

        .search-form select:focus {
            border: 0;
        }

        .search-form button {
            height: 33px;
            width: 100%;
            font-size: 1rem;
        }

        .search-form button svg {
            width: 17px;
            height: 17px;
        }

        .card-margin {
            margin-bottom: 1.875rem;
        }

        .card {
            border: 0;
            box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
            -webkit-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
            -moz-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
            -ms-box-shadow: 0px 0px 10px 0px rgba(82, 63, 105, 0.1);
        }
        .card {
            position: relative;
            display: flex;
            flex-direction: column;
            min-width: 0;
            word-wrap: break-word;
            background-color: #ffffff;
            background-clip: border-box;
            border: 1px solid #e6e4e9;
            border-radius: 8px;
        }

    </style>


    <div class="row" >
        <div class="col-lg-12 card-margin">
            <div class="card search-form">
                <div class="card-body p-0">
                    <div class="row" >
                        <div class="col-12">
                            <div class="row no-gutters" >
                                <div class="col-3" >
                                    <p:selectOneMenu id="languageSelect" value="#{selectedTheso.selectedLang}"
                                                     class="form-control" title="#{langueBean.getMsg('search.change_thesaurus_language')}"
                                                     style="background: transparent; border-color: transparent; background-color: transparent; font-size: 12px;
                                                     padding-top: 2px; width: 100%; padding-left: 5px;">
                                        <p:ajax event="valueChange"  update="containerIndex" listener="#{selectedTheso.changeLang()}" />
                                        <f:selectItems value="#{selectedTheso.nodeLangs}" var="lang" itemLabel="#{lang.value}" itemValue="#{lang.code}"/>
                                        <f:selectItem itemLabel="#{langueBean.getMsg('search.any_language')}" itemValue="all"/>
                                    </p:selectOneMenu>
                                </div>
                                <div class="col-8">
                                    <p:autoComplete class="form-control" value="#{searchBean.searchSelected}" var="values" placeholder="Rechercher..." 
                                                    completeMethod="#{searchBean.completTermFullText}" minQueryLength="1" itemLabel="#{values.prefLabel}" 
                                                    itemValue="#{values}" converter="searchConverterAdvanced" scrollHeight="600"
                                                    inputStyle="font-size: 14px; width: 100%; height: 100%; box-shadow: none; padding-top: 10px"
                                                    style="background-color: transparent; border-color: transparent; width: 100%; font-size: 12px;">

                                        <!-- Type prefLabel -->
                                        <p:column rendered="#{values.isConcept}">
                                            <h:panelGroup rendered="#{values.isDeprecated}">
                                                <i class="fa fa-solid fa-ban fa_custom_ban"></i>
                                                <h:outputText title="#{values.idConcept}" value=" #{values.prefLabel}"  style="font-size: 12px;color: #C63632; font-weight: bold; font-style: italic"/>
                                            </h:panelGroup>
                                            <h:outputText rendered="#{!values.isDeprecated}" title="#{values.idConcept}" value="#{values.prefLabel}"  style="font-size: 12px;"/>
                                        </p:column>    



                                        <!-- Type altLabel -->
                                        <p:column rendered="#{values.isAltLabel}">
                                            <h:outputText title="#{values.idConcept}" value="#{values.altLabel} -> "  style="font-style: italic;font-size: 12px;color: blue;" />
                                            <h:panelGroup rendered="#{values.isDeprecated}">
                                                <i class="fa fa-solid fa-ban fa_custom_ban"></i>
                                                <h:outputText title="#{values.idConcept}" value=" #{values.prefLabel}"  style="font-size: 12px;color: #C63632; font-weight: bold; font-style: italic"/>                                                    
                                            </h:panelGroup>                                                
                                            <h:outputText rendered="#{!values.isDeprecated}" title="#{values.idConcept}" value="#{values.prefLabel}" style="font-size: 12px;" />                                        
                                        </p:column>

                                        <!-- Type Collection -->
                                        <p:column rendered="#{values.isGroup}">
                                            <i class="fa fa-folder fa_custom_collapse" />
                                            <h:outputText title="#{values.idConcept}" value=" #{values.prefLabel}"  
                                                          style="font-size: 12px; color: #093b29; font-weight: bold; font-style: italic"/>
                                        </p:column>  

                                        <!-- Type Facette -->
                                        <p:column rendered="#{values.isFacet}">
                                            <i class="fa fa-magnet fa_custom_magnet" />
                                            <h:outputText title="#{values.idConcept}" value=" #{values.prefLabel}"  
                                                          style="font-size: 12px; color: #78261f; font-weight: bold; font-style: italic"/>
                                        </p:column>                                              

                                        <p:ajax event="itemSelect" listener="#{searchBean.onSelect}" update="messageIndex"/>
                                    </p:autoComplete>
                                </div>
                                <div class="col-1" style="text-align: right; ">
                                    <p:commandLink class="btn btn-base" actionListener="#{searchBean.applySearch()}" 
                                                   update="containerIndex:sideBarSearch" oncomplete="PF('resultatRecherche').show();">
                                        <i class="fas fa-search fa-1x" style="color: #f47b2a; font-size: 14px;"/>
                                    </p:commandLink>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="row" style="width: 100%; margin-top: -25px;">
        <div class="col-11" style="display:flex; flex-direction: row; justify-content: center; align-items: center;" >
            <h:panelGroup id="choixPanel">
                <p:selectBooleanCheckbox id="select1" itemLabel="#{langueBean.getMsg('search.startWith')}" value="#{searchBean.indexMatch}" 
                                         style="color: #000; background-color: transparent; font-size: 12px;">
                    <p:ajax listener="#{searchBean.activateIndexMatch()}" update="choixPanel"/>
                    <p:tooltip for="select1" value="#{langueBean.getMsg('search.tooltip_startWith')}" showDelay="1000" position="bottom"/>
                </p:selectBooleanCheckbox>

                <p:selectBooleanCheckbox id="select2" itemLabel="#{langueBean.getMsg('search.exact')}" value="#{searchBean.exactMatch}"
                                         style="color: #000; background-color: transparent; font-size: 12px;">
                    <p:ajax listener="#{searchBean.activateExactMatch()}" update="choixPanel"/>
                    <p:tooltip for="select2" value="#{langueBean.getMsg('search.search_exact_word')}" showDelay="1000" position="bottom"/>                    
                </p:selectBooleanCheckbox>

                <p:selectBooleanCheckbox id="select3" itemLabel="#{langueBean.getMsg('search.note')}" value="#{searchBean.withNote}"
                                         style="color: #000; background-color: transparent; font-size: 12px;">
                    <p:ajax listener="#{searchBean.activateWithNote()}" update="choixPanel"/>
                    <p:tooltip for="select3" value="#{langueBean.getMsg('search.search_only_note')}" showDelay="1000" position="bottom"/>                    
                </p:selectBooleanCheckbox>

                <p:selectBooleanCheckbox id="select4" itemLabel="#{langueBean.getMsg('search.identifier')}" value="#{searchBean.withId}"
                                         style="color: #000; background-color: transparent; font-size: 12px;">
                    <p:ajax listener="#{searchBean.activateWithId()}"  update="choixPanel"/>
                    <p:tooltip for="select4" value="#{langueBean.getMsg('search.search_by_identifier')} (Id, Ark, Handle, Notation)" showDelay="1000" position="bottom"/>                    
                </p:selectBooleanCheckbox>
                
                <p:selectCheckboxMenu id="select5" value="#{roleOnTheso.selectedThesoForSearch}" label="Thesorus" style="color: #000; font-size: 12px; height: 28px;"
                    panelStyle="width: 15rem; font-size: 1rem; " scrollHeight="250" >
                    <f:selectItems value="#{roleOnTheso.listTheso}" var="theso" itemLabel="#{theso.getNom()}" itemValue="#{theso.getId()}"/>
                </p:selectCheckboxMenu>

                <p:menuButton rendered="#{currentUser.nodeUser != null}" id="searchProgrammed" style="font-size: 12px;" icon="pi pi-align-justify">

                    <p:menuitem value="Poly-hiérarchie" action="#{searchBean.getAllPolyierarchy()}" 
                                update="containerIndex:formRightTab" 
                                title="Rechercher les concepts polyhiérarchiques"/>

                    <p:menuitem value="Multi-groupes" action="#{searchBean.searchConceptWithMultiGroup()}" 
                                update="containerIndex:formRightTab"
                                title="Rechercher les concepts qui ont plusieurs groupes"/>

                    <p:menuitem value="Sans-groupes" action="#{searchBean.searchConceptWithoutGroup()}" 
                                update="containerIndex:formRightTab"
                                title="Rechercher les concepts qui n'ont pas de groupes"/>

                    <p:menuitem value="Doublons" action="#{searchBean.searchConceptDuplicated()}" 
                                update="containerIndex:formRightTab"
                                title="Rechercher les concepts qui ont un libellé en doublon"/>

                    <p:menuitem value="Relations interdites" action="#{searchBean.searchConceptWithRTandBT()}" 
                                update="containerIndex:formRightTab"
                                title="Rechercher les concepts qui ont une relation interdite, à la fois RT et (NT ou BT)"/>
                </p:menuButton>
                <p:tooltip for="searchProgrammed" value="#{langueBean.getMsg('search.preprogrammedSearch')}" showDelay="1000" position="bottom"/>
            </h:panelGroup>
        </div>
        
        <div class="col-1" style="text-align: right;">
                <p:commandButton icon="pi pi-bookmark" styleClass="rounded-button ui-button-secondary ui-button-outlined"
                                 actionListener="#{searchBean.afficherResultatRecherche()}"/>
        </div>        
        
    </div>
    <h:form id="formSearch">

    </h:form>
</ui:fragment>